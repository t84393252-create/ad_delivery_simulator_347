# System Architecture & Flow Diagrams

## ğŸ“Š Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   EXTERNAL CLIENTS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Publishers]          [Advertisers]           [Analytics]          [Monitoring]     â”‚
â”‚      â†“                      â†“                       â†“                    â†“           â”‚
â”‚  Bid Requests         Campaign Mgmt           Get Metrics         Health Checks      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                      â”‚                    â”‚                   â”‚
       â–¼                      â–¼                    â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            LOAD BALANCER / API GATEWAY                              â”‚
â”‚                                  (HTTP/HTTPS)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              GIN HTTP ROUTER                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ /bid-requestâ”‚  /campaigns  â”‚    /track    â”‚   /metrics   â”‚   /health    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚              â”‚              â”‚              â”‚
         â–¼             â–¼              â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            BUSINESS LOGIC LAYER                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ â”‚   AUCTION    â”‚ â”‚   CAMPAIGN   â”‚ â”‚   TRACKING   â”‚ â”‚  ANALYTICS   â”‚               â”‚
â”‚ â”‚   ENGINE     â”‚ â”‚   SERVICE    â”‚ â”‚   SERVICE    â”‚ â”‚   SERVICE    â”‚               â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚ â”‚ â€¢ Bid eval   â”‚ â”‚ â€¢ CRUD ops   â”‚ â”‚ â€¢ Events     â”‚ â”‚ â€¢ Metrics    â”‚               â”‚
â”‚ â”‚ â€¢ Targeting  â”‚ â”‚ â€¢ Budget     â”‚ â”‚ â€¢ Batching   â”‚ â”‚ â€¢ Reports    â”‚               â”‚
â”‚ â”‚ â€¢ Scoring    â”‚ â”‚ â€¢ Pacing     â”‚ â”‚ â€¢ Validation â”‚ â”‚ â€¢ Aggregationâ”‚               â”‚
â”‚ â”‚ â€¢ Winner     â”‚ â”‚ â€¢ Frequency  â”‚ â”‚ â€¢ Streaming  â”‚ â”‚ â€¢ Real-time  â”‚               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚                â”‚                â”‚
         â–¼                â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DATA ACCESS LAYER                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚     REDIS       â”‚  â”‚     KAFKA       â”‚  â”‚   POSTGRESQL    â”‚                    â”‚
â”‚  â”‚   (Cache)       â”‚  â”‚   (Streams)     â”‚  â”‚   (Database)    â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
â”‚  â”‚ â€¢ Budgets      â”‚  â”‚ â€¢ Bid events    â”‚  â”‚ â€¢ Campaigns     â”‚                    â”‚
â”‚  â”‚ â€¢ Freq caps    â”‚  â”‚ â€¢ Impressions   â”‚  â”‚ â€¢ Creatives     â”‚                    â”‚
â”‚  â”‚ â€¢ Hot data     â”‚  â”‚ â€¢ Clicks        â”‚  â”‚ â€¢ History       â”‚                    â”‚
â”‚  â”‚ â€¢ Counters     â”‚  â”‚ â€¢ Conversions   â”‚  â”‚ â€¢ Reports       â”‚                    â”‚
â”‚  â”‚ â€¢ Rate limits  â”‚  â”‚ â€¢ Analytics     â”‚  â”‚ â€¢ Transactions  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Complete Bid Request Flow

```
[1] Publisher Website
         â”‚
         â–¼
    Ad Space Available
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Bid Request    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
         â”‚                                           â–¼
         â–¼                                   [Request Details]
    Gin Router                               â€¢ User ID
         â”‚                                   â€¢ Site info
         â–¼                                   â€¢ Ad size
  Auction Engine                             â€¢ Floor price
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€[2] Fetch Campaignsâ”€â”€â”€â”€â”€â”€â–¶ Campaign Service
         â”‚                                        â”‚
         â”‚                                        â–¼
         â”‚                                  Redis (Budget Check)
         â”‚                                        â”‚
         â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€ Active Campaigns â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€[3] Check Targetingâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                        â”‚
         â”‚   â€¢ Geography match?                   â”‚
         â”‚   â€¢ Device type match?                 â”‚
         â”‚   â€¢ User segment match?                â”‚
         â”‚   â€¢ Time window match?                 â”‚
         â”‚                                        â”‚
         â”œâ”€â”€â”€â”€â”€â”€[4] Frequency Checkâ”€â”€â”€â”€â”€â”€â–¶ Redis â”‚
         â”‚                                   â”‚    â”‚
         â”‚â—€â”€â”€â”€â”€â”€â”€ Under cap? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
         â”‚                                        â”‚
         â”œâ”€â”€â”€â”€â”€â”€[5] Calculate Bidsâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚   For each eligible campaign:
         â”‚   â€¢ Base bid amount
         â”‚   â€¢ Performance multiplier
         â”‚   â€¢ Budget pacing factor
         â”‚   â€¢ Competition estimate
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€[6] Run Auctionâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                        â”‚
         â”‚   Sort bids by price                  â”‚
         â”‚   Winner = highest bidder              â”‚
         â”‚   Price = 2nd highest + $0.01         â”‚
         â”‚                                        â”‚
         â”œâ”€â”€â”€â”€â”€â”€[7] Decrement Budgetâ”€â”€â”€â”€â”€â–¶ Redis â”‚
         â”‚                                        â”‚
         â”œâ”€â”€â”€â”€â”€â”€[8] Log Eventâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Kafka â”‚
         â”‚                                        â”‚
         â–¼                                        â–¼
    [Response]                              [Async Processing]
    â€¢ Ad creative                           â€¢ Analytics
    â€¢ Tracking URLs                         â€¢ Reporting
    â€¢ Win notification                      â€¢ Billing
```

## ğŸ“ˆ Event Tracking Flow

```
User Sees/Clicks Ad
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tracking Event  â”‚
â”‚ (Browser/App)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    HTTP POST
    /track/{type}
         â”‚
         â–¼
    Gin Router
         â”‚
         â–¼
  Tracking Service
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚Validate â”‚
    â”‚ Event   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Parallel Processing      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â–¼           â–¼         â–¼        â–¼
Redis      In-Memory   Kafka   Response
Counter    Buffer      Queue   to Client
    â”‚           â”‚         â”‚        â”‚
    â”‚           â”‚         â”‚        â–¼
    â”‚           â”‚         â”‚    [200 OK]
    â”‚           â”‚         â”‚
    â”‚           â–¼         â–¼
    â”‚      [Batch]    [Stream]
    â”‚      100 events  Process
    â”‚           â”‚         â”‚
    â”‚           â–¼         â–¼
    â”‚      PostgreSQL  Analytics
    â”‚      (Bulk Save) Pipeline
    â”‚
    â–¼
[Real-time Metrics]
â€¢ Dashboard updates
â€¢ Budget tracking
â€¢ Performance KPIs
```

## ğŸ’° Campaign Management Flow

```
Advertiser Dashboard
         â”‚
         â–¼
  [Campaign Request]
  â€¢ Name & Budget
  â€¢ Targeting rules
  â€¢ Bid strategy
  â€¢ Schedule
         â”‚
         â–¼
    API Gateway
         â”‚
         â–¼
  Campaign Service
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Validation          â”‚
    â”‚   â€¢ Budget > 0        â”‚
    â”‚   â€¢ Valid dates       â”‚
    â”‚   â€¢ Targeting valid   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    [Success]
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Parallel Operations       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â–¼         â–¼          â–¼          â–¼
PostgreSQL  Redis      Kafka    Response
(Persist)   (Cache)    (Event)  (201 Created)
    â”‚         â”‚          â”‚          â”‚
    â”‚         â”‚          â”‚          â–¼
    â”‚         â”‚          â”‚     [Campaign ID]
    â”‚         â”‚          â”‚
    â”‚         â–¼          â–¼
    â”‚    [Hot Data]   [Notify]
    â”‚    â€¢ Budget     â€¢ DSPs
    â”‚    â€¢ Status     â€¢ Reports
    â”‚    â€¢ Targeting  â€¢ Billing
    â”‚
    â–¼
[Persistent Storage]
â€¢ Full history
â€¢ Audit trail
â€¢ Compliance
```

## ğŸ”„ Data Synchronization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SYNC PATTERNS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  PostgreSQL â”€â”€[Write-through]â”€â”€â–¶ Redis              â”‚
â”‚      â†‘                             â†“                â”‚
â”‚      â”‚                        [TTL Expiry]          â”‚
â”‚      â”‚                             â†“                â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€[Lazy Load]â”€â”€â”€â”€â”€â”€ Cache Miss           â”‚
â”‚                                                      â”‚
â”‚  Kafka â”€â”€[Consumer Groups]â”€â”€â–¶ Multiple Services     â”‚
â”‚      â†‘                                              â”‚
â”‚      â”‚                                              â”‚
â”‚   Events â”€â”€[Producer]â”€â”€â–¶ Topics                     â”‚
â”‚                                                      â”‚
â”‚  Redis â”€â”€[Pub/Sub]â”€â”€â–¶ Real-time Updates            â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš¦ Service Communication Matrix

| From â†“ / To â†’ | Auction Engine | Campaign Service | Tracking Service | Redis | Kafka | PostgreSQL |
|----------------|---------------|------------------|------------------|-------|-------|------------|
| **Auction Engine** | - | Sync (HTTP) | - | Direct | Async | - |
| **Campaign Service** | - | - | - | Direct | Async | Direct |
| **Tracking Service** | - | Sync (HTTP) | - | Direct | Async | Batch |
| **Redis** | - | - | - | - | - | - |
| **Kafka** | Consume | Consume | Consume | - | - | - |
| **PostgreSQL** | Read | Read/Write | Write | - | - | - |

## ğŸ” Security & Monitoring Layer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  OBSERVABILITY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Prometheus â—€â”€â”€[Metrics]â”€â”€â”€â”€ All Services              â”‚
â”‚      â”‚                                                  â”‚
â”‚      â–¼                                                  â”‚
â”‚  Grafana â”€â”€[Dashboards]â”€â”€â–¶ Operations Team             â”‚
â”‚                                                         â”‚
â”‚  Logrus â”€â”€[Structured Logs]â”€â”€â–¶ Log Aggregator          â”‚
â”‚                                                         â”‚
â”‚  Health Checks â”€â”€[Liveness]â”€â”€â–¶ Load Balancer           â”‚
â”‚                                                         â”‚
â”‚  Circuit Breakers â”€â”€[Protection]â”€â”€â–¶ Downstream         â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Performance Optimization Points

```
[Caching Strategy]
L1: In-Memory (Goroutine local) - <1Î¼s
L2: Redis (Shared cache) - <1ms  
L3: PostgreSQL (Source) - <10ms

[Concurrency Model]
â€¢ Worker Pools: 100 goroutines
â€¢ Channel Buffers: 10,000 events
â€¢ Batch Processing: 100 records
â€¢ Connection Pools: 25 DB, 10 Redis

[Rate Limiting]
â€¢ Per endpoint: 1000 RPS
â€¢ Per client: 100 RPS
â€¢ Circuit breaker: 50% error rate
â€¢ Retry policy: 3 attempts
```

## ğŸ¯ Key Design Decisions

1. **Why Separate Services?**
   - Independent scaling
   - Fault isolation
   - Team ownership
   - Deploy independently

2. **Why Redis + PostgreSQL?**
   - Redis: Speed for real-time operations
   - PostgreSQL: ACID compliance for financial data

3. **Why Kafka?**
   - Decouples producers/consumers
   - Handles backpressure
   - Enables replay
   - Horizontal scaling

4. **Why Go + Gin?**
   - High concurrency
   - Low latency
   - Simple deployment
   - Strong typing

This architecture handles 1000+ RPS with <100ms latency while maintaining data consistency and providing real-time analytics.